
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta content="Using light to perform tasks beyond the reach of classical computers. " property="og:description" />
<meta content="https://pennylane.ai/qml/_images/tutorial_gbs_expt2.png" property="og:image" />

  

  <meta property="og:title" content="Quantum advantage with Gaussian Boson Sampling &#8212; PennyLane">
  <meta property="og:url" content="https://pennylane.ai/qml/demos/tutorial_gbs.html">
  <meta name="twitter:card" content="summary_large_image">

  
  
  <meta content="Using light to perform tasks beyond the reach of classical computers. " name="description" />
  

  <link href="https://fonts.googleapis.com/css?family=Noto+Serif" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Noto+Sans" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">

  <!-- Font Awesome -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
  <!-- Bootstrap core CSS -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">

  <!-- Material Design Bootstrap -->
  <!-- <link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/css/mdb.min.css" rel="stylesheet"> -->

  <!-- nanoscroller -->
  <link rel="stylesheet" type="text/css" href="../_static/css/nanoscroller.css" />

  <!-- lightslider -->
  <link type="text/css" rel="stylesheet" href="../_static/css/lightslider.min.css" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script type="text/x-mathjax-config">
     MathJax.Hub.Config({
       "HTML-CSS": { scale: 90, linebreaks: { automatic: true } },
       SVG: { linebreaks: { automatic: true } },
       TeX: {
         Macros: {
           pr : ['|\#1\\rangle\\langle\#1|',1],
           ket: ['\\left| \#1\\right\\rangle',1],
           bra: ['\\left\\langle \#1\\right|',1],
           xket: ['\\left| \#1\\right\\rangle_x',1],
           xbra: ['\\left\\langle \#1\\right|_x',1],
           braket: ['\\langle \#1 \\rangle',1],
           braketD: ['\\langle \#1 \\mid \#2 \\rangle',2],
           braketT: ['\\langle \#1 \\mid \#2 \\mid \#3 \\rangle',3],
           ketbra: ['| #1 \\rangle \\langle #2 |',2],
           hc: ['\\text{h.c.}',0],
           cc: ['\\text{c.c.}',0],
           h: ['\\hat',0],
           nn: ['\\nonumber',0],
           di: ['\\frac{d}{d \#1}',1],
           bm: ['\\mathbf{\#1}',1],
           uu: ['\\mathcal{U}',0],
           inn: ['\\text{in}',0],
           out: ['\\text{out}',0],
           vac: ['\\text{vac}',0],
           I: ['I',0],
           x: ['\\hat{x}',0],
           p: ['\\hat{p}',0],
           a: ['\\hat{a}',0],
           ad: ['\\hat{a}^\\dagger',0],
           n: ['\\hat{n}',0],
           nbar: ['\\overline{n}',0],
           sech: ['\\mathrm{sech~}',0],
           tanh: ['\\mathrm{tanh~}',0],
           re: ['\\text{Re}',0],
           im: ['\\text{Im}',0],
           tr: ['\\mathrm{Tr} #1',1],
           diag: ['\\mathrm{diag} #1',1],
           sign: ['\\text{sign}',0],
           overlr: ['\\overset\\leftrightarrow{\#1}',1],
           overl: ['\\overset\leftarrow{\#1}',1],
           overr: ['\\overset\rightarrow{\#1}',1],
           avg: ['\\left< \#1 \\right>',1],
           slashed: ['\\cancel{\#1}',1],
           bold: ['\\boldsymbol{\#1}',1],
           d: ['\\mathrm d',0]
         }
       }
     });
     </script>
      <!-- Global site tag (gtag.js) - Google Analytics -->
      <script async src="https://www.googletagmanager.com/gtag/js?id=UA-130507810-1"></script>
      <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());

        gtag('config', 'UA-130507810-1');
      </script>

  <title>Quantum advantage with Gaussian Boson Sampling &#8212; PennyLane</title>
  
    <link rel="stylesheet" href="../_static/xanadu.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/xanadu_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/gallery-rendered-html.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-MML-AM_CHTML"></script>
    <link rel="canonical" href="https://pennylane.ai/qml/demos/tutorial_gbs.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Learning to learn with quantum neural networks" href="learning2learn.html" />
    <link rel="prev" title="Understanding the Haar Measure" href="tutorial_haar_measure.html" /> 
  </head><body><link rel="stylesheet" type="text/css" href="../_static/xanadu_gallery.css" />
  <!--Navbar-->
<nav class="navbar navbar-expand-lg navbar-light white sticky-top">

  <!-- Navbar brand -->
  <a class="navbar-brand" href="https://pennylane.ai">
    <img class="pr-1" src="../_static/xanadu_x.png" width="28px"></img>
    <img src="../_static/pennylane.png" width="180px"></img>
  </a>

  <!-- Collapse button -->
  <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#basicExampleNav"
    aria-controls="basicExampleNav" aria-expanded="false" aria-label="Toggle navigation">
    <span class="navbar-toggler-icon"></span>
  </button>

  <!-- Collapsible content -->
  <div class="collapse navbar-collapse" id="basicExampleNav">

    <!-- Links -->
    <ul class="navbar-nav mr-auto">
      <li class="nav-item active">
        <a class="nav-link" href="https://pennylane.ai/qml">Quantum machine learning
          <span class="sr-only">(current)</span>
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://pennylane.ai/install.html">Install</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://pennylane.ai/plugins.html">Plugins</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://pennylane.readthedocs.io">Documentation</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://pennylane.ai/blog">Blog</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://qhack.ai"><img src="https://pennylane.ai/img/qhack_plain_black.png"></a>
      </li>
    </ul>
    <!-- Links -->

    <ul class="navbar-nav ml-auto nav-flex-icons">
      <li class="nav-item">
        <a class="nav-link" href="http://pennylane.ai/faq.html">
          <i class="fab fas fa-question"></i> FAQ
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://discuss.pennylane.ai">
          <i class="fab fab fa-discourse"></i> Support
        </a>
      </li>
      <li class="nav-item">
        <a class="nav-link" href="https://github.com/XanaduAI/PennyLane">
          <i class="fab fa-github"></i> GitHub
        </a>
      </li>
    </ul>
  </div>
  <!-- Collapsible content -->
</nav>
<!--/.Navbar-->
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="learning2learn.html" title="Learning to learn with quantum neural networks"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="tutorial_haar_measure.html" title="Understanding the Haar Measure"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demos_research.html" accesskey="U">Research</a> &#187;</li> 
      </ul>
    </div>
        <div id="content">


          <div id="right-column">
            <div class="document clearer body">

              <div class="container-wrapper">

                <div role="navigation" aria-label="breadcrumbs navigation">
                  <ol class="breadcrumb">
                  </ol>
                </div>

              
  <div class="sphx-glr-download-link-note admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Click <a class="reference internal" href="#sphx-glr-download-demos-tutorial-gbs-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="quantum-advantage-with-gaussian-boson-sampling">
<span id="sphx-glr-demos-tutorial-gbs-py"></span><h1>Quantum advantage with Gaussian Boson Sampling<a class="headerlink" href="#quantum-advantage-with-gaussian-boson-sampling" title="Permalink to this headline">¶</a></h1>
<p><script type="text/javascript">
    var related_tutorials = ["tutorial_gaussian_transformation.html", "qsim_beyond_classical.html", "qonn.html"];
    var related_tutorials_titles = ['Gaussian transformation', 'Beyond classical computing with qsim', 'Optimizing a quantum optical neural network'];
</script></p>
<p><em>Author: PennyLane dev team. Posted: 4 Dec 2020. Last updated: 4 Dec 2020.</em></p>
<p>On the journey to large-scale fault-tolerant quantum computers, one of the first major
milestones is to demonstrate a quantum device carrying out tasks that are beyond the reach of
any classical algorithm. The Google Quantum team was the first to claim this achievement,
announced in their paper <a class="reference external" href="https://www.nature.com/articles/s41586-019-1666-5">Quantum supremacy using a programmable superconducting
processor</a> <a class="footnote-reference" href="#arute2019" id="id1">[1]</a>. Now a team led
by Chao-Yang Lu and Jian-Wei Pan has performed a similar feat using quantum photonics. While
Google’s experiment performed the task of <a class="reference internal" href="qsim_beyond_classical.html"><span class="doc">random circuit sampling</span></a>
using a superconducting processor, the new experiment, published in the paper
<a class="reference external" href="https://science.sciencemag.org/content/early/2020/12/02/science.abe8770?rss=1">Quantum computational advantage using photons</a>
<a class="footnote-reference" href="#zhong2020" id="id2">[2]</a> leverages the quantum properties of light to tackle a task called
<a class="reference external" href="https://strawberryfields.ai/photonics/concepts/gbs.html">Gaussian Boson Sampling</a> (GBS).</p>
<p>This tutorial will walk you through the basic elements of GBS, motivate why it is
classically challenging, and show you how to explore GBS using PennyLane and the photonic
quantum devices accessible via the
<a class="reference external" href="https://pennylane-sf.readthedocs.io">PennyLane-Strawberry Fields plugin</a>. If you are
interested in possible applications of GBS, or want to access programmable GBS hardware
via the cloud, check out the
<a class="reference external" href="https://strawberryfields.ai/">Strawberry Fields website</a> for more details.</p>
<div class="line-block">
<div class="line"><br /></div>
</div>
<a class="reference external image-reference" href="javascript:void(0);"><img alt="../_images/tutorial_gbs_expt2.png" class="align-center" src="../_images/tutorial_gbs_expt2.png" style="width: 80%;" /></a>
<div class="figure align-center" id="id9">
<a class="reference external image-reference" href="javascript:void(0);"><img alt="../_images/tutorial_gbs_expt1.png" src="../_images/tutorial_gbs_expt1.png" style="width: 80%;" /></a>
<p class="caption"><span class="caption-text"><em>Illustration of the experimental setup used by Zhong et al. in Quantum computational advantage
using photons</em> <a class="footnote-reference" href="#zhong2020" id="id3">[2]</a>.</span></p>
</div>
<div class="section" id="the-origins-of-gbs">
<h2>The origins of GBS<a class="headerlink" href="#the-origins-of-gbs" title="Permalink to this headline">¶</a></h2>
<p>Let’s first explain the name. <a class="reference external" href="https://en.wikipedia.org/wiki/Boson">Boson</a> refers to bosonic
matter, which, along with fermions, makes up one of the two elementary classes of particles.
The most prevalent bosonic system in our everyday lives is light, which is made of particles
called photons. Another famous example, though much harder to find, is the Higgs boson.
The distinguishing characteristic of bosons is that they follow “Bose-Einstein statistics”,
which very loosely means that the particles like to bunch together (contrast this to fermionic
matter like electrons, which must follow the Pauli Exclusion Principle and keep apart).</p>
<p>This property can be observed in simple interference experiments such as the
<a class="reference external" href="https://en.wikipedia.org/wiki/Hong%E2%80%93Ou%E2%80%93Mandel_effect">Hong-Ou Mandel setup</a>.
If two single photons are interfered on a balanced beamsplitter, they will both emerge at
the same output port—there is zero probability that they will emerge at separate outputs.
This is a simple but notable quantum property of light; if electrons were brought
together in a similar experiement, they would always appear at separate output ports.</p>
<p>Gaussian Boson Sampling <a class="footnote-reference" href="#hamilton2017" id="id4">[3]</a> is, in fact, a member of a larger family of
“Boson Sampling” algorithms,
stemming back to the initial proposal of Aaronson and Arkhipov <a class="footnote-reference" href="#aaronson2013" id="id5">[4]</a> in 2013.
Boson Sampling is quantum interferometry writ large. Aaronson and Arkhipov’s original proposal
was to inject many single photons into distinct input ports of a large interferometer, then
measure which output ports they appear at. The natural interference properties of bosons
means that photons will appear at the output ports in very unique and specific ways. Boson
Sampling was not proposed with any kind of practical real-world use-case in mind. Like
the random circuit sampling, it’s just a quantum system being its best self. With sufficient
size and quality, it is strongly believed to be hard for a classical computer to simulate this efficiently.</p>
<p>Finally, the “Gaussian” in GBS refers to the fact that we modify the original Boson Sampling
proposal slightly: instead of injecting single photons—which are hard to jointly create in the
size and quality needed to demonstrate Boson Sampling conclusively—we instead use states of
light that are experimentally less demanding (though still challenging!).
These states of light are called Gaussian states,
because they bear strong connections to the
<a class="reference external" href="https://en.wikipedia.org/wiki/Normal_distribution">Gaussian (or Normal) distribution</a>
from statistics. In practice, we use a particular Gaussian state called a
<a class="reference external" href="https://en.wikipedia.org/wiki/Squeezed_states_of_light">squeezed state</a> for the inputs,
since these are arguably the most non-classical of Gaussian states.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">While computationally hard to simulate, Boson Sampling devices, on their own,
are not capable of universal quantum computing. However, in combination with other
components, GBS is a key building block for a
universal device <a class="footnote-reference" href="#bourassa2020" id="id6">[5]</a>.</p>
</div>
</div>
<div class="section" id="coding-a-gbs-algorithm">
<h2>Coding a GBS algorithm<a class="headerlink" href="#coding-a-gbs-algorithm" title="Permalink to this headline">¶</a></h2>
<p>The researchers in <a class="footnote-reference" href="#zhong2020" id="id7">[2]</a> experimentally demonstrate a GBS device by preparing 50
squeezed states and injecting them into a 100-mode interferometer. In this demo,
in order to keep things classically simulable, we will stick to a much simpler setting
consisting of 4 squeezed states injected into a 4-mode interferometer. At a high level,
an interferometer on <span class="math notranslate nohighlight">\(N\)</span> modes can be represented using an <span class="math notranslate nohighlight">\(N\times N\)</span> unitary
matrix <span class="math notranslate nohighlight">\(U\)</span>. When decomposed into a quantum optical circuit, the interferometer will
be made up of beamsplitters and phase shifters.</p>
<a class="reference external image-reference" href="javascript:void(0);"><img alt="../_images/tutorial_gbs_circuit2.png" class="align-center" src="../_images/tutorial_gbs_circuit2.png" style="width: 90%;" /></a>
<br><p>Simulating this circuit using PennyLane is easy; we can simply read off the gates from left
to right, and convert it into a QNode.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># set the random seed</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>

<span class="c1"># import PennyLane</span>
<span class="kn">import</span> <span class="nn">pennylane</span> <span class="k">as</span> <span class="nn">qml</span>
</pre></div>
</div>
<p>We must define the unitary matrix we would like to embed in the circuit.
We will use SciPy to generate a Haar-random unitary:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">unitary_group</span>

<span class="c1"># define the linear interferometer</span>
<span class="n">U</span> <span class="o">=</span> <span class="n">unitary_group</span><span class="o">.</span><span class="n">rvs</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">U</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.23648826-0.48221431j  0.06829648+0.04447898j  0.51150074-0.09529866j
   0.55205719-0.35974699j]
 [-0.11148167+0.69780321j -0.24943828+0.08410701j  0.46705929-0.43192981j
   0.16220654-0.01817602j]
 [-0.22351926-0.25918352j  0.24364996-0.05375623j -0.09259829-0.53810588j
   0.27267708+0.66941977j]
 [ 0.11519953-0.28596729j -0.90164923-0.22099186j -0.09627758-0.13105595j
  -0.0200152 +0.12766128j]]
</pre></div>
</div>
<p>We can now use this to construct the circuit, choosing a compatible
device. For the simulation, we can use the Strawberry Fields
Gaussian backend. This backend is perfectly suited for simulation of GBS,
as the initial states are Gaussian, and all gates transform Gaussian states to other
Gaussian states.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">n_wires</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">cutoff</span> <span class="o">=</span> <span class="mi">10</span>

<span class="n">dev</span> <span class="o">=</span> <a href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.device.html#pennylane.device" title="pennylane.device" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">device</span></a><span class="p">(</span><span class="s2">&quot;strawberryfields.gaussian&quot;</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">n_wires</span><span class="p">,</span> <span class="n">cutoff_dim</span><span class="o">=</span><span class="n">cutoff</span><span class="p">)</span>

<span class="nd">@qml</span><span class="o">.</span><span class="n">qnode</span><span class="p">(</span><span class="n">dev</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">gbs_circuit</span><span class="p">():</span>
    <span class="c1"># prepare the input squeezed states</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">):</span>
        <a href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.Squeezing.html#pennylane.Squeezing" title="pennylane.Squeezing" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Squeezing</span></a><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>

    <span class="c1"># linear interferometer</span>
    <a href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.Interferometer.html#pennylane.Interferometer" title="pennylane.Interferometer" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class"><span class="n">qml</span><span class="o">.</span><span class="n">Interferometer</span></a><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">))</span>
    <span class="k">return</span> <a href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.probs.html#pennylane.probs" title="pennylane.probs" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-function"><span class="n">qml</span><span class="o">.</span><span class="n">probs</span></a><span class="p">(</span><span class="n">wires</span><span class="o">=</span><span class="nb">range</span><span class="p">(</span><span class="n">n_wires</span><span class="p">))</span>
</pre></div>
</div>
<p>A couple of things to note in this particular example:</p>
<ol class="arabic simple">
<li>To prepare the input single mode squeezed vacuum state <span class="math notranslate nohighlight">\(\ket{re^{i\phi}}\)</span>,
where <span class="math notranslate nohighlight">\(r = 1\)</span> and <span class="math notranslate nohighlight">\(\phi=0\)</span>, we
apply a squeezing gate (<a class="reference external" href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.Squeezing.html#pennylane.Squeezing" title="(in PennyLane v0.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Squeezing</span></code></a>) to each of the wires (initially in
the vacuum state).</li>
<li>Next we apply the linear interferometer to all four wires using
<a class="reference external" href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.Interferometer.html#pennylane.Interferometer" title="(in PennyLane v0.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Interferometer</span></code></a> and the unitary matrix <code class="docutils literal notranslate"><span class="pre">U</span></code>. This operator
decomposes the unitary matrix representing the linear interferometer into single-mode
rotation gates (<a class="reference external" href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.PhaseShift.html#pennylane.PhaseShift" title="(in PennyLane v0.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">PhaseShift</span></code></a>) and two-mode beamsplitters
(<a class="reference external" href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.Beamsplitter.html#pennylane.Beamsplitter" title="(in PennyLane v0.17)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Beamsplitter</span></code></a>). After applying the interferometer, we will denote the
output state by <span class="math notranslate nohighlight">\(\ket{\psi'}\)</span>.</li>
<li>GBS takes place physically in an infinite-dimensional Hilbert space,
which is not practical for simulation. We need to set an upper limit on the maximum
number of photons we can detect. This is the
<code class="docutils literal notranslate"><span class="pre">cutoff</span></code> value we defined above; we will only be considering detection events
containing 0 to 9 photons per mode.</li>
</ol>
<p>We can now execute the QNode, and extract the resulting probability distribution:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">probs</span> <span class="o">=</span> <a href="https://pennylane.readthedocs.io/en/stable/code/api/pennylane.QNode.html#pennylane.QNode" title="pennylane.QNode" class="sphx-glr-backref-module-pennylane sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">gbs_circuit</span></a><span class="p">()</span><span class="o">.</span><span class="n">reshape</span><span class="p">([</span><span class="n">cutoff</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_wires</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>/home/runner/work/qml/qml/demonstrations/tutorial_gbs.py:165: UserWarning: &#39;Interferometer&#39; is deprecated and will be renamed &#39;InterferometerUnitary&#39;
(10, 10, 10, 10)
</pre></div>
</div>
<p>For example, element <code class="docutils literal notranslate"><span class="pre">[1,2,0,1]</span></code> represents the probability of
detecting 1 photon on wire
<code class="docutils literal notranslate"><span class="pre">0</span></code> and wire <code class="docutils literal notranslate"><span class="pre">3</span></code>, and 2 photons at wire <code class="docutils literal notranslate"><span class="pre">1</span></code>, i.e., the value</p>
<div class="math notranslate nohighlight">
\[\text{prob}(1,2,0,1) = \left|\braketD{1,2,0,1}{\psi'}\right|^2.\]</div>
<p>Let’s extract and view the probabilities of measuring various Fock states.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Fock states to measure at output</span>
<span class="n">measure_states</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">)]</span>

<span class="c1"># extract the probabilities of calculating several</span>
<span class="c1"># different Fock states at the output, and print them out</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">measure_states</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;|</span><span class="si">{</span><span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">j</span><span class="p">)</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">i</span><span class="p">)</span><span class="si">}</span><span class="s2">&gt;: </span><span class="si">{</span><span class="n">probs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>|0000&gt;: 0.17637844761413501
|1100&gt;: 0.034732936494202844
|0101&gt;: 0.011870900427255577
|1111&gt;: 0.005957399165336121
|2000&gt;: 0.029573843083205452
</pre></div>
</div>
</div>
<div class="section" id="the-gbs-distribution">
<h2>The GBS Distribution<a class="headerlink" href="#the-gbs-distribution" title="Permalink to this headline">¶</a></h2>
<p>Hamilton et al. <a class="footnote-reference" href="#hamilton2017" id="id8">[3]</a> showed that the probability of
measuring a final state containing only 0 or 1 photons per mode is given by</p>
<div class="math notranslate nohighlight">
\[\left|\left\langle{n_1,n_2,\dots,n_N}\middle|{\psi'}\right\rangle\right|^2 =
\frac{\left|\text{Haf}[(U(\bigoplus_i\tanh(r_i))U^T)]_{st}\right|^2}{\prod_{i=1}^N \cosh(r_i)}\]</div>
<p>i.e., the sampled single-photon probability distribution is proportional to the <strong>hafnian</strong> of a
submatrix of <span class="math notranslate nohighlight">\(U(\bigoplus_i\tanh(r_i))U^T\)</span>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The hafnian of a matrix is defined by</p>
<div class="math notranslate nohighlight">
\[\text{Haf}(A) = \sum_{\sigma \in \text{PMP}_{2N}}\prod_{i=1}^N A_{\sigma(2i-1)\sigma(2i)},\]</div>
<p>where <span class="math notranslate nohighlight">\(\text{PMP}_{2N}\)</span> is the set of all perfect matching permutations of <span class="math notranslate nohighlight">\(2N\)</span> elements. In graph theory, the
hafnian calculates the number of perfect <a class="reference external" href="https://en.wikipedia.org/wiki/Matching_(graph_theory)">matchings</a> in a graph with
adjacency matrix <span class="math notranslate nohighlight">\(A\)</span>.</p>
<p>Compare this to the permanent, which calculates the number of perfect matchings on a <em>bipartite</em>
graph. Notably, the permanent appears in vanilla Boson Sampling in a similar way
that the hafnian appears in GBS.
The hafnian turns out to be a generalization of the permanent, with the relationship</p>
<div class="last math notranslate nohighlight">
\[\begin{split}\text{Per(A)} = \text{Haf}\left(\left[\begin{matrix}
    0&amp;A\\ A^T&amp;0
\end{matrix}\right]\right).\end{split}\]</div>
</div>
<p>As any algorithm that could calculate (or even approximate) the hafnian could also calculate the
permanent—a <a class="reference external" href="https://en.wikipedia.org/wiki/%E2%99%AFP">#P-hard problem</a>—it follows that
calculating or approximating the hafnian must also be a classically hard problem. This lies behind
the classical hardness of GBS.</p>
<p>In this demo, we will use the same squeezing parameter, <span class="math notranslate nohighlight">\(z=r\)</span>, for
all input states; this allows us to simplify this equation. To start with, the hafnian expression
simply becomes <span class="math notranslate nohighlight">\(\text{Haf}[(UU^T\tanh(r))]_{st}\)</span>, removing the need for the direct sum.</p>
<p>Thus, we have</p>
<div class="math notranslate nohighlight">
\[\left|\left\langle{n_1,n_2,\dots,n_N}\middle|{\psi'}\right\rangle\right|^2 =
\frac{\left|\text{Haf}[(UU^T\tanh(r))]_{st}\right|^2}{n_1!n_2!\cdots n_N!\cosh^N(r)}.\]</div>
<p>Now that we have the theoretical formulas, as well as the probabilities from our simulated GBS
QNode, we can compare the two and see whether they agree.</p>
<p>In order to calculate the probability of different GBS events classically, we need a
method for calculating the hafnian.
For this, we will use <a class="reference external" href="https://the-walrus.readthedocs.io">The Walrus</a> library (which is installed as a dependency of the
PennyLane-SF plugin):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">thewalrus</span> <span class="kn">import</span> <span class="n">hafnian</span> <span class="k">as</span> <span class="n">haf</span>
</pre></div>
</div>
<p>Now, for the right-hand side numerator, we first calculate the submatrix
<span class="math notranslate nohighlight">\(A = [(UU^T\tanh(r))]_{st}\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>In GBS, we determine the submatrix by taking the
rows and columns corresponding to the measured Fock state. For example, to calculate the submatrix
in the case of the output measurement <span class="math notranslate nohighlight">\(\left|{1,1,0,0}\right\rangle\)</span>,
we have</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">A</span><span class="p">[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]][[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>[[ 0.19343159-0.54582922j  0.43418269-0.09169615j]
 [ 0.43418269-0.09169615j -0.27554025-0.46222197j]]
</pre></div>
</div>
<p>i.e., we consider only the rows and columns where a photon was detected, which gives us
the submatrix corresponding to indices <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(1\)</span>.</p>
</div>
<div class="section" id="comparing-to-simulation">
<h2>Comparing to simulation<a class="headerlink" href="#comparing-to-simulation" title="Permalink to this headline">¶</a></h2>
<p>Now that we have a method for calculating the hafnian, let’s compare the output to that provided by
the PennyLane QNode.</p>
<p><strong>Measuring</strong> <span class="math notranslate nohighlight">\(\ket{0,0,0,0}\)</span> <strong>at the output</strong></p>
<p>This corresponds to the hafnian of an <em>empty</em> matrix, which is simply 1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.1763784476141347
0.17637844761413501
</pre></div>
</div>
<p><strong>Measuring</strong> <span class="math notranslate nohighlight">\(\ket{1,1,0,0}\)</span> <strong>at the output</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mi">1</span><span class="p">))[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]][[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">haf</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.03473293649420271
0.034732936494202844
</pre></div>
</div>
<p><strong>Measuring</strong> <span class="math notranslate nohighlight">\(\ket{0,1,0,1}\)</span> <strong>at the output</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mi">1</span><span class="p">))[:,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]][[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">haf</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.011870900427255547
0.011870900427255577
</pre></div>
</div>
<p><strong>Measuring</strong> <span class="math notranslate nohighlight">\(\ket{1,1,1,1}\)</span> <strong>at the output</strong></p>
<p>This corresponds to the hafnian of the full matrix <span class="math notranslate nohighlight">\(A=UU^T\tanh(r)\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">haf</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.005957399165336084
0.005957399165336121
</pre></div>
</div>
<p><strong>Measuring</strong> <span class="math notranslate nohighlight">\(\ket{2,0,0,0}\)</span> <strong>at the output</strong></p>
<p>Since we have two photons in mode <code class="docutils literal notranslate"><span class="pre">q[0]</span></code>, we take two copies of the
first row and first column, making sure to divide by <span class="math notranslate nohighlight">\(2!\)</span>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">A</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">U</span><span class="p">,</span> <span class="n">U</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="mi">1</span><span class="p">))[:,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]][[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">haf</span><span class="p">(</span><span class="n">A</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cosh</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">**</span> <span class="mi">4</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">probs</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>0.02957384308320539
0.029573843083205452
</pre></div>
</div>
<p>The PennyLane simulation results agree (with almost negligible numerical error) to the
expected result from the Gaussian boson sampling equation!</p>
<p>This demo provides an entry-level walkthrough to the ideas behind GBS,
providing you with the basic code needed for exploring the ideas behind
the photonic quantum advantage paper. Try changing the number of modes,
the number of injected squeezed states, or the cutoff dimension, and
see how each of these affect the classical computation time. If you’re
interested in learning more about GBS, or about photonic quantum
computing in general, the
<a class="reference external" href="https://strawberryfields.ai/">Strawberry Fields website</a> is a great resource.</p>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<table class="docutils footnote" frame="void" id="arute2019" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[1]</a></td><td>Arute, F., Arya, K., Babbush, R., et al. “Quantum supremacy using a programmable
superconducting processor”
<a class="reference external" href="https://doi.org/10.1038/s41586-019-1666-5">Nature 574, 505-510 (2019)</a>.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="zhong2020" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id3">2</a>, <a class="fn-backref" href="#id7">3</a>)</em> Zhong, H.-S., Wang, H., Deng, Y.-H., et al. (2020). Quantum computational advantage using photons. Science, 10.1126/science.abe8770.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="hamilton2017" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[3]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id8">2</a>)</em> Craig S. Hamilton, Regina Kruse, Linda Sansoni, Sonja Barkhofen, Christine Silberhorn,
and Igor Jex. Gaussian boson sampling. Physical Review Letters, 119:170501, Oct 2017.
arXiv:1612.01199, doi:10.1103/PhysRevLett.119.170501.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="aaronson2013" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[4]</a></td><td>Scott Aaronson and Alex Arkhipov. The computational complexity of linear optics. Theory of
Computing, 9(1):143–252, 2013. doi:10.4086/toc.2013.v009a004.</td></tr>
</tbody>
</table>
<table class="docutils footnote" frame="void" id="bourassa2020" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id6">[5]</a></td><td>Bourassa, J. E., Alexander, R. N., Vasmer, et al. (2020). Blueprint for a scalable
photonic fault-tolerant quantum computer. arXiv preprint arXiv:2010.02905.</td></tr>
</tbody>
</table>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  2.069 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-demos-tutorial-gbs-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<a class="reference download internal" download="" href="../_downloads/6ec5aee0028f7f298f9f97f8a2f7a3ea/tutorial_gbs.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">tutorial_gbs.py</span></code></a></div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<a class="reference download internal" download="" href="../_downloads/1ad0ef9aa98fb92185a3a69a9a65e6d2/tutorial_gbs.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">tutorial_gbs.ipynb</span></code></a></div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


              <div id="bottom-dl" class="xanadu-call-to-action-links">
                <div id="tutorial-type">demos/tutorial_gbs</div>
                <div class="download-python-link">
                  <i class="fab fa-python"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Python script</div>
                </div>
                <div class="download-notebook-link">
                  <i class="fas fa-download"></i>&nbsp;
                  <div class="call-to-action-desktop-view">Download Notebook</div>
                </div>
                <div class="github-view-link">
                  <i class="fab fa-github"></i>&nbsp;
                  <div class="call-to-action-desktop-view">View on GitHub</div>
                </div>
              </div>
            </div>
          </div>
              <div class="comment-container nano has-scrollbar">
  <div class="nano-content">
    
    <div id="comments">
      <h3>Contents</h3>
      <ul>
<li><a class="reference internal" href="#">Quantum advantage with Gaussian Boson Sampling</a><ul>
<li><a class="reference internal" href="#the-origins-of-gbs">The origins of GBS</a></li>
<li><a class="reference internal" href="#coding-a-gbs-algorithm">Coding a GBS algorithm</a></li>
<li><a class="reference internal" href="#the-gbs-distribution">The GBS Distribution</a></li>
<li><a class="reference internal" href="#comparing-to-simulation">Comparing to simulation</a></li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>

    </div>
    
    <div class="xanadu-call-to-action-links">
      <h3>Downloads</h3>
      <div id="tutorial-type">demos/tutorial_gbs</div>
      <div class="download-python-link">
        <i class="fab fa-python"></i>&nbsp;
        <div class="call-to-action-desktop-view">Download Python script</div>
      </div>
      <div class="download-notebook-link">
        <i class="fas fa-download"></i>&nbsp;
        <div class="call-to-action-desktop-view">Download Notebook</div>
      </div>
      <div class="github-view-link">
        <i class="fab fa-github"></i>&nbsp;
        <div class="call-to-action-desktop-view">View on GitHub</div>
      </div>
      <div id="related-tutorials" class="mt-4">
      <h3> Related tutorials</h3>
      </div>
    </div>
  </div>
</div>
            

          <div class="up-button">
            
              
                <a href="../demos_research.html"><i class="fas fa-angle-double-left"></i></a>
              
            
          </div>

          <div class="clearfix"></div>
        </div>


    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="learning2learn.html" title="Learning to learn with quantum neural networks"
             >next</a> |</li>
        <li class="right" >
          <a href="tutorial_haar_measure.html" title="Understanding the Haar Measure"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PennyLane  documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../demonstrations.html" >Demos</a> &#187;</li>
          <li class="nav-item nav-item-2"><a href="../demos_research.html" >Research</a> &#187;</li> 
      </ul>
    </div>

    <!-- JQuery -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
    <!-- Bootstrap core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <!-- MDB core JavaScript -->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>
    <!-- Nanoscroller -->
    <script type="text/javascript" src="../_static/js/nanoscroller.min.js"></script>
    <script type="text/javascript">
        $('a.reference.external').each(function(){
          var link = $(this).attr("href");
          var hash = link.split('#')[1];
          var page = link.split('#')[0].split('/').slice(-1)[0].replace(".html", "");
          if (hash == page) {
            $(this).attr('href', link.split('#')[0]);
          }
        });
        $(".document > .section").removeClass("section");
        var tocContainer = document.querySelector('.comment-container');
        tocContainer.style.height = '85vh';
        $(".nano").nanoScroller();
    </script>
    <!-- lightslider -->
    <script src="../_static/js/lightslider.min.js"></script>

    <script type="text/javascript">
      $(window).scroll(function(){
          var windowHeight = window.innerHeight;
          var footer = document.querySelector('.page-footer');
          var footerPosition = footer.getBoundingClientRect();
          var tocContainer = document.querySelector('.comment-container');

          // Check if the footer is visible
          if (footerPosition.top < windowHeight && footerPosition.bottom >= 0) {
              // We want the height of the TOC to be the height of the main content minus how much of the footer is visible.
              tocContainer.style.height = 'calc(85vh - 45px - ' + (windowHeight - footerPosition.top) + 'px)'
          } else {
            // When the user scrolls back to the top of the page after scrolling to the bottom of the page,
            // We want to reset the TOC container back to it's original height
            if (tocContainer.style.height !== '85vh') tocContainer.style.height = '85vh';
          }
      });
      $(document).ready(function () {
          $(".css-transitions-only-after-page-load").each(function (index, element) {
              setTimeout(function () { $(element).removeClass("css-transitions-only-after-page-load") }, 10);
          });
      });
    </script>

    <script type="text/javascript">
    var downloadNote = $(".sphx-glr-download-link-note.admonition.note");
    if (downloadNote.length >= 1) {
      var tutorialUrlArray = $("#tutorial-type").text().split('/');

      if (tutorialUrlArray[0] == "demos") {
        tutorialUrlArray[0] = "demonstrations";
      }

      var githubLink = "https://github.com/" + "XanaduAI/qml" + "/blob/master/" + tutorialUrlArray.join("/") + ".py",
          pythonLink = $(".sphx-glr-download .reference.download")[0].href,
          notebookLink = $(".sphx-glr-download .reference.download")[1].href,
          notebookDownloadPath = notebookLink.split('_downloads')[1].split('/').pop();

      $(".download-python-link").wrap("<a href=" + pythonLink + " data-behavior='call-to-action-event' data-response='Download Python script' download target='_blank'/>");
      $(".download-notebook-link").wrap("<a href=" + notebookLink + " data-behavior='call-to-action-event' data-response='Download Notebook' download target='_blank'/>");
      $(".github-view-link").wrap("<a href=" + githubLink + " data-behavior='call-to-action-event' data-response='View on Github' target='_blank'/>");
      $("#right-column").addClass("page-shadow");
    } else {
      $(".xanadu-call-to-action-links").hide();
      $("#bottom-dl").attr('style','display: none !important');
    }
    </script>

    <script type="text/javascript">
      function makeUL(urls, text) {
          var list = document.createElement('ul');

          for (var i = 0; i < urls.length; i++) {
              var item = document.createElement('li');
              var a = document.createElement('a');
              var linkText = document.createTextNode(text[i]);
              a.appendChild(linkText);
              a.href = urls[i];
              item.appendChild(a);
              list.appendChild(item);
          }
          return list;
      }

      if (typeof related_tutorials !== 'undefined') {
          document.getElementById('related-tutorials').appendChild(makeUL(related_tutorials, related_tutorials_titles));
          $("#related-tutorials ul li a").append(' <i class="fas fa-angle-double-right" style="font-size: smaller;"></i>')
          $("#related-tutorials").show();
      }
    </script>


    <script type="text/javascript">
        $(document).ready(function() {
            $("#featured-demos").lightSlider({
                item: 3,
                autoWidth: false,
                slideMove: 1, // slidemove will be 1 if loop is true
                slideMargin: 0,
                auto: true,
                loop: true,
                controls: true,
                pause: 5000,
                pager: false,
                prevHtml: "<i class='fas fa-chevron-left black-text' style='font-size: xx-large;'></i>",
                nextHtml: "<i class='fas fa-chevron-right black-text' style='font-size: xx-large;'></i>",
                responsive : [
                    {
                        breakpoint:1400,
                        settings: {
                            item:2,
                            slideMove:1,
                            slideMargin:0,
                          }
                    },
                    {
                        breakpoint:768,
                        settings: {
                            item:1,
                            slideMove:1,
                            slideMargin:6,
                          }
                    }
                ]
            });
        });
    </script>


  <footer class="page-footer text-md-left pt-4">
  
    <hr class="pb-0 mb-0">
    <div class="container-fluid">
      <div class="row   justify-content-md-center">
        <div class="col-md-3">
          <h5 class=" mb-1 footer-heading">Xanadu</h5>
          <hr width=100px class="d-inline-block mt-0 mb-1 Deep-purple accent-4">
          <p class="">Located in the heart of downtown Toronto, we've brought together exceptional minds from around the world to build quantum computers that are useful and available to people everywhere.</p>
        </div>

    <div class="col-md-2 col-4">
          <h5 class=" mb-1 footer-heading">PennyLane</h5>
          <hr width=100px class="d-inline-block mt-0 mb-1 Deep-purple accent-4">
          <ul class="list-unstyled">
            <li><a class="" href="https://pennylane.ai/">Home page</a></li>
            <li><a class="" href="https://github.com/XanaduAI/pennylane">GitHub</a></li>
            <li><a class="" href="https://pennylane.readthedocs.io/">Documentation</a></li>
            <li><a class="" href="https://discuss.pennylane.ai/">Discussion forum</a></li>
            <li><a class="" href="https://twitter.com/pennylaneai/">Twitter</a></li>
          </ul>
        </div>
		<div class="col-md-2 col-4">
          <h5 class=" mb-1 footer-heading">Strawberry Fields</h5>
          <hr width=100px class="d-inline-block mt-0 mb-1 Deep-purple accent-4">
          <ul class="list-unstyled">
            <li><a class="" href="https://strawberryfields.ai/">Interactive</a></li>
            <li><a class="" href="https://github.com/XanaduAI/strawberryfields">GitHub</a></li>
            <li><a class="" href="https://strawberryfields.readthedocs.io/">Documentation</a></li>
            <li><a class="" href="https://u.strawberryfields.ai/slack/">Slack channel</a></li>
          </ul>
        </div>


        <div class="col-md-2 col-4">
          <h5 class=" mb-1 footer-heading">About</h5>
          <hr width=100px class="d-inline-block mt-0 mb-1 Deep-purple accent-4">
          <ul class="list-unstyled">
            <li><a class="" href="https://www.xanadu.ai/">Home</a></li>
            <li><a class="" href="https://www.xanadu.ai/hardware/">Hardware</a></li>
            <li><a class="" href="https://www.xanadu.ai/software/">Software</a></li>
            <li><a class="" href="https://www.xanadu.ai/research">Research</a></li>
            <li><a class="" href="https://medium.com/XanaduAI">Blog</a></li>
            <li><a class="" href="https://www.xanadu.ai/about/">About</a></li>
          </ul>
        </div>
      </div>
    </div>
    <hr>

    <!-- <hr class="pb-0 mb-0"> -->

    <!--Social buttons-->
    <div class="social-section text-center">
        <ul class="list-unstyled list-inline mb-0">
            <li class="list-inline-item"><a class="btn-fb" href="https://www.facebook.com/Xanadu-1312050742230493/"><i class="fab fa-facebook-f"> </i></a></li>
            <li class="list-inline-item"><a class="btn-tw" href="https://twitter.com/xanaduai"><i class="fab fa-twitter"> </i></a></li>
            <li class="list-inline-item"><a class="" href="https://medium.com/xanaduai"><i class="fab fa-medium-m"> </i></a></li>
            <li class="list-inline-item"><a class="btn-li" href="https://www.linkedin.com/company/xanaduai/"><i class="fab fa-linkedin-in"> </i></a></li>
            <li class="list-inline-item"><a class="btn-git" href="https://github.com/XanaduAI"><i class="fab fa-github"> </i></a></li>
        </ul>
        <a href="https://xanadu.us17.list-manage.com/subscribe?u=725f07a1d1a4337416c3129fd&id=294b062630" style="font-size: initial;">Stay updated with our newsletter</a>
    </div>
    <!--/.Social buttons-->

    <!--Copyright-->
    <div class="footer-copyright py-3 mt-0 text-center">
        <div class="container-fluid">
            © Copyright 2019 | Xanadu | All rights reserved
            <br>
             TensorFlow, the TensorFlow logo and any related marks are trademarks of Google Inc. 
        </div>
    </div>
  </footer>
  </body>
</html>